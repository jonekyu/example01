--캠핑장테이블 생성
CREATE TABLE CAMP(
  CNO CHAR(3) PRIMARY KEY NOT NULL,
  CNAME VARCHAR(100) NOT NULL,
  JUSO VARCHAR(500),
  TEL VARCHAR(20)
);

INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('100', '도토리캠핑장', '강원도', '010-1010-1010');
INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('101', '솔밭캠핑장', '경기도', '010-1010-2020');
INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('102', '하늘캠핑장', '인천', '010-1010-3030');
SELECT * FROM CAMP;

--시설물 테이블
CREATE TABLE FACIL(
  FNO INT PRIMARY KEY NOT NULL,
  FNAME VARCHAR(100) NOT NULL
);
INSERT INTO FACIL VALUES(0,'전기');
INSERT INTO FACIL VALUES(1,'수도');
INSERT INTO FACIL VALUES(2,'와이파이');
INSERT INTO FACIL VALUES(3,'화장실');
INSERT INTO FACIL VALUES(4,'수영장');
SELECT * FROM FACIL;

--타입 테이블
CREATE TABLE TYPE(
  TNO INT PRIMARY KEY NOT NULL,
  TNAME VARCHAR(100) NOT NULL
);
INSERT INTO TYPE VALUES(0, '카라반');
INSERT INTO TYPE VALUES(1, '글램핑');
INSERT INTO TYPE VALUES(2, '오토캠핑');
INSERT INTO TYPE VALUES(3, '펜션');
SELECT * FROM TYPE;

--캠핑장별 시설물
CREATE TABLE CAMP_FACIL(
  CNO CHAR(3) NOT NULL,
  FNO INT NOT NULL,
  PRIMARY KEY(CNO, FNO),
  FOREIGN KEY(CNO) REFERENCES CAMP(CNO),
  FOREIGN KEY(FNO) REFERENCES FACIL(FNO)
);  
  
--캠핑장별 타일
CREATE TABLE CAMP_TYPE(
  CNO CHAR(3) NOT NULL,
  TNO INT NOT NULL,
  PRIMARY KEY(CNO, TNO),
  FOREIGN KEY(CNO) REFERENCES CAMP(CNO),
  FOREIGN KEY(TNO) REFERENCES TYPE(TNO)
);  

--100번 캠핑장에 시설물 0,1,2
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',1);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',2);
--101번 캠핑장에 시설물 0,1
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('101',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('101',1);
--102번 캠핑장에 시설물 0,3
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('102',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('102',3);
SELECT * FROM CAMP_FACIL;

--100번 캠핑장에 1,2
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('100',1);
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('100',2);
--101번 시설물 1
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('101',1);
--102번 시설물 2
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('102',2);
SELECT * FROM CAMP_TYPE;

COMMIT;

--캠핑장별 시설물번호, 시설물이름
SELECT C.*, F.FNAME
FROM CAMP_FACIL C, FACIL F
WHERE C.FNO=F.FNO;

--캠핑장별 유형번호, 유형이름
SELECT C.*, T.TNAME
FROM CAMP_TYPE C, TYPE T
WHERE C.TNO=T.TNO;

--학생 테이블 생성
CREATE TABLE STUDENTS(
  SCODE CHAR(6) NOT NULL PRIMARY KEY,
  SNAME VARCHAR(20) NOT NULL,
  DEPT VARCHAR(20) NOT NULL
);

DESC STUDENTS;

--과목 테이블 생성
CREATE TABLE COURSES(
  CCODE CHAR(3) NOT NULL PRIMARY KEY,
  CNAME VARCHAR(100) NOT NULL
);

--수강신청 테이블 생성
CREATE TABLE ENROLS(
  SCODE CHAR(6) NOT NULL,
  CCODE CHAR(3) NOT NULL,
  GRADE INT DEFAULT 0,
  EDATE DATE DEFAULT SYSDATE,
  PRIMARY KEY(SCODE,CCODE),
  FOREIGN KEY(SCODE) REFERENCES STUDENTS(SCODE),
  FOREIGN KEY(CCODE) REFERENCES COURSES(CCODE)
);

INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES('202301','홍길동','컴정');
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES('202302','심청이','컴정');
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES('202303','이순신','컴정');
SELECT * FROM STUDENTS;

INSERT INTO COURSES(CCODE, CNAME)
VALUES('100', '자바');
INSERT INTO COURSES(CCODE, CNAME)
VALUES('101', '데이터베이스');
INSERT INTO COURSES(CCODE, CNAME)
VALUES('102', 'HTML');
SELECT * FROM COURSES;

INSERT INTO ENROLS(SCODE, CCODE)
VALUES('202301','100');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES('202301','102');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES('202302','101');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES('202302','102');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES('202303','102');

SELECT * FROM ENROLS;

CREATE VIEW VIEW_ENROLS AS
SELECT E.*, S.SNAME, C.CNAME
FROM ENROLS E, STUDENTS S, COURSES C
WHERE E.SCODE=S.SCODE AND C.CCODE=E.CCODE;

SELECT * FROM VIEW_ENROLS ORDER BY SCODE;
COMMIT;

SELECT MAX(SCODE)+1 NCODE FROM STUDENTS;
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES(SELECT MAX(SCODE)+1 NCODE FROM STUDENTS, '김길동', '전자');

